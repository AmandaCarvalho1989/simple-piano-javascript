<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
    <title>Piano</title>
  </head>
  <body>
    <div id="piano-container">
      <div class="controls">
        <button class="notes" id="notesButton">Notes</button>
        <button class="record" id="recordButton"></button>
        <button class="play" id="playButton">Play</button>
        <button>Pause</button>
      </div>
      <div class="piano">
        <button data-note="C" class="key white"></button>
        <button data-note="Db" class="key black"></button>
        <button data-note="D" class="key white"></button>
        <button data-note="E" class="key black"></button>
        <button data-note="Eb" class="key white"></button>
        <button data-note="F" class="key white"></button>
        <button data-note="Gb" class="key black"></button>
        <button data-note="G" class="key white"></button>
        <button data-note="Ab" class="key black"></button>
        <button data-note="A" class="key white"></button>
        <button data-note="Bb" class="key black"></button>
        <button data-note="B" class="key white"></button>
      </div>
    </div>
    <audio id="C" src="notes/C.mp3"></audio>
    <audio id="Db" src="notes/Db.mp3"></audio>
    <audio id="D" src="notes/D.mp3"></audio>
    <audio id="E" src="notes/E.mp3"></audio>
    <audio id="Eb" src="notes/Eb.mp3"></audio>
    <audio id="F" src="notes/F.mp3"></audio>
    <audio id="Gb" src="notes/Gb.mp3"></audio>
    <audio id="G" src="notes/G.mp3"></audio>
    <audio id="Ab" src="notes/Ab.mp3"></audio>
    <audio id="A" src="notes/A.mp3"></audio>
    <audio id="B" src="notes/B.mp3"></audio>
    <audio id="Bb" src="notes/Bb.mp3"></audio>

    <script>
      let isRecording = false;
      let recordedAudio = null;

      const recordButton = document.getElementById("recordButton");
      const playButton = document.getElementById("playButton");
      const pianoKeys = document.querySelectorAll(".key");
      const pressedKeys = [];

      recordButton.addEventListener("click", toggleRecording);
      playButton.addEventListener("click", playRecording);

      pianoKeys.forEach((key) => {
        key.addEventListener("click", () => {
          if (isRecording) {
            pressedKeys.push(key);
          }
        });
      });

      function toggleRecording() {
        if (!isRecording) {
          isRecording = true;
          recordButton.classList.add("active");
        } else {
          isRecording = false;
          recordButton.classList.remove("active");
        }
      }

      function playRecording() {
        let index = 0;

        function playNext() {
          if (index >= pressedKeys.length) return;

          const key = pressedKeys[index];
          const note = key.dataset.note;
          const audio = document.querySelector(`#${note}`);

          if (!audio) {
            index++;
            playNext();
            return;
          }

          audio.onended = () => {
            index++;
            playNext();
          };

          audio.play();
        }
        playNext();
      }
    </script>

    <script>
      let isNotesVisible = false;

      const notesButton = document.getElementById("notesButton");
      const keyboardKeys = document.querySelectorAll(".key");

      notesButton.addEventListener("click", toggleShowNotes);

      function toggleShowNotes() {
        if (!isNotesVisible) {
          isNotesVisible = true;
          showNotes();
        } else {
          isNotesVisible = false;
          hideNotes()
        }
      }

      function showNotes() {
        return keyboardKeys.forEach(
          (key) => (key.textContent = key.dataset.note)
        );
      }

      function hideNotes() {
        return keyboardKeys.forEach(
          (key) => (key.textContent ="")
        );
      }
    </script>
  </body>
</html>
